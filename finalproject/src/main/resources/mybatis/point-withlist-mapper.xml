<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="pointWishlist">

    <insert id="insert">
        INSERT INTO POINT_WITH_LIST (WITH_LIST_NO, WITH_LIST_MEMBER_ID, WITH_LIST_ITEM_NO)
        VALUES (SEQ_POINT_WITH_LIST.NEXTVAL, #{memberId}, #{itemNo})
    </insert>

 <delete id="delete">
        DELETE FROM POINT_WITH_LIST 
        WHERE WITH_LIST_MEMBER_ID = #{memberId}   AND WITH_LIST_ITEM_NO = #{itemNo}       </delete>

    <select id="checkWish" resultType="int">
        SELECT COUNT(*) FROM POINT_WITH_LIST 
        WHERE WITH_LIST_MEMBER_ID = #{memberId} AND WITH_LIST_ITEM_NO = #{itemNo}
    </select>
    
    <select id="selectMyWishItemNos" resultType="int">
        SELECT WITH_LIST_ITEM_NO 
        FROM POINT_WITH_LIST 
        WHERE WITH_LIST_MEMBER_ID = #{memberId}
    </select>

   <select id="selectMyWishlist" resultType="PointWishlistDto">
    SELECT 
        T1.WITH_LIST_NO        AS withListNo,
        T1.WITH_LIST_MEMBER_ID AS withListMemberId,
        T1.WITH_LIST_ITEM_NO   AS withListItemNo,
        T1.WITH_LIST_DATE      AS withListDate,
        
        T2.POINT_ITEM_NAME     AS pointItemName,
        T2.POINT_ITEM_SRC      AS pointItemSrc,
        T2.POINT_ITEM_PRICE    AS pointItemPrice
    FROM 
        POINT_WITH_LIST T1
    INNER JOIN 
        POINT_ITEM T2 ON T1.WITH_LIST_ITEM_NO = T2.POINT_ITEM_NO
    WHERE 
        T1.WITH_LIST_MEMBER_ID = #{memberId}
    ORDER BY 
        T1.WITH_LIST_DATE DESC
</select>
</mapper>