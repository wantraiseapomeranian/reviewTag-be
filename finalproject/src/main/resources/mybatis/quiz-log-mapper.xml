<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="quizLog">

	<!-- 퀴즈 풀이 기록 등록 -->
	<select id="sequence" resultType="long">
		select quiz_log_seq.nextval from dual
	</select>
	
	<insert id="insert">
		insert into quiz_log
		(
		quiz_log_id, quiz_log_member_id, 
		quiz_log_quiz_id, 
		quiz_log_is_correct
		)
		values
		(
		#{quizLogId}, #{quizLogMemberId}, 
		#{quizLogQuizId}, 
		#{quizLogIsCorrect}
		)
	</insert>
	
	<!-- 어떤 사람이 해당 문제를 풀었는지 조회(관리자용) -->
	<select id="selectList" resultType="QuizLogDto">
		select * from quiz_log
		where quiz_log_quiz_id = #{quizLogQuizId}
	</select>
	
	<!-- 퀴즈 기록 상세 정보 조회 -->
	<select id="detail" resultType="QuizLogDto">
		select * from quiz_log
		where quiz_log_id = #{quizLogId}
	</select>
	
	<!-- 마이페이지 전용 구문 -->
	<select id="selectListByMember" resultType="QuizLogDto">
		select * from quiz_log
		where quiz_log_member_id = #{quizLogMemberId}
		order by quiz_log_solved_at desc
	</select>
	
	<!-- 랭킹을 위한 조회 구문 -->
	<select id="countCorrectAnswer" resultType="int">
		select count(*) from quiz_log
		where quiz_log_member_id = #{quizLogMemberId}
		  and quiz_log_is_correct = 'Y'
	</select>
</mapper>



